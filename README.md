# OneDrive下载助手 - 简单好用的文件下载工具 📥

## 这是个啥？🤔

这是一个超级好用的OneDrive文件下载工具，主要有这些功能：
1. 可以下载你自己OneDrive里的任何文件和文件夹
2. 可以下载别人分享给你的OneDrive文件
3. 提供了一个交互式的文件浏览器，让你可以像在Windows资源管理器一样浏览文件
4. 支持断点续传，下载中断了也不怕

## 主要文件说明 📁

- `onedrive_downloader.py`: 下载你自己OneDrive里的文件
- `onedrive_downloader_shared.py`: 下载别人分享给你的文件
- `browse_onedrive_with_shared.py`: 交互式文件浏览器，可以浏览文件结构
- `config.py`: 配置文件，存放一些重要的设置

## 怎么用？🚀

### 第一步：准备工作

1. 确保你的电脑上安装了Python（版本3.6或更高）
2. 安装需要的Python包：
   ```bash
   pip install msal requests python-dotenv
   ```
3. 在Azure门户注册一个应用（这个有点专业，如果不会弄可以问老师要现成的）

### 第二步：配置

1. 创建一个`.env`文件，填入这些信息：
   ```
   CLIENT_ID=你的应用ID
   TENANT_ID=你的租户ID
   ```

### 第三步：开始使用

#### 方式一：用文件浏览器（推荐新手用这个）
```bash
python browse_onedrive_with_shared.py
```
这个会打开一个交互式界面，你可以：
- 用`cd 数字`进入文件夹
- 用`cd ..`返回上一级
- 用`shared`查看别人分享给你的文件
- 用`home`回到你的OneDrive根目录
- 用`download`下载当前文件夹

#### 方式二：直接下载指定文件夹
```bash
python onedrive_downloader.py
```
然后输入你想下载的文件夹路径就行

#### 方式三：下载分享文件
```bash
python onedrive_downloader_shared.py
```
需要输入分享文件的ID（可以从浏览器里先看到）

## 特色功能 ✨

1. 智能续传：如果下载中断了，重新运行就会自动跳过已下载的文件
2. 进度显示：下载时会显示进度条和文件大小
3. 令牌缓存：登录一次后，下次就不用重新登录了
4. 支持大文件：不管多大的文件都能下载
5. 文件夹递归：可以一次性下载整个文件夹，包括所有子文件夹

## 注意事项 ⚠️

1. 第一次使用时需要登录Microsoft账号授权
2. 下载的文件会保存在`downloads`文件夹里
3. 如果遇到下载错误，可以重试，已下载的文件不会重复下载
4. 分享文件下载需要知道文件ID，可以先用浏览器查看

## 遇到问题？🤔

常见问题：
1. 如果显示"无法获取访问令牌"，检查一下你的`.env`文件配置是否正确
2. 如果下载很慢，可能是网络问题，重试就好
3. 如果显示"API请求失败"，可能是权限不够，检查一下是不是有权限访问这个文件

希望这个说明对你有帮助！如果还有不明白的地方，随时问我！😊
